This is Jeff's modification to this enormous application.
